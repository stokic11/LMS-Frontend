<div class="table-wrapper">
	<div class="table-actions">
		<button *ngIf="showAddButton" 
		        mat-raised-button 
		        color="primary" 
		        (click)="onAddClick()" 
		        class="add-btn">
			<mat-icon>{{ addButtonIcon }}</mat-icon>
			{{ addButtonLabel }}
		</button>
		<button *ngIf="showDownloadButton"
		        mat-raised-button 
		        color="accent" 
		        (click)="openDownloadModal()" 
		        class="download-btn">
			<mat-icon>download</mat-icon>
			Preuzmi
		</button>
	</div>
	
	<div class="table-container">
		<table>
			<thead>
				<tr>
					<th *ngFor="let col of columns" (click)="setSort(col.key)" style="cursor:pointer">
						{{ col.label }}
						<span *ngIf="sortColumn === col.key">
							{{ sortDirection === 'asc' ? 'â–²' : 'â–¼' }}
						</span>
					</th>
					<th *ngIf="hasActions">Akcije</th>
				</tr>
			</thead>
			<tbody>
				<tr *ngFor="let row of pagedData; trackBy: trackByFn" 
				    [class.clickable]="rowClickable" 
				    (click)="onRowClick(row)">
					<td *ngFor="let col of columns">
						<span *ngIf="!col.pipe; else pipeCell">{{ row[col.key] }}</span>
						<ng-template #pipeCell>
							<span [ngSwitch]="col.pipe">
								<span *ngSwitchCase="'date'">{{ parseDate(row[col.key]) | date: col.pipeArgs }}</span>
								<span *ngSwitchDefault>{{ row[col.key] }}</span>
							</span>
						</ng-template>
					</td>
					<td *ngIf="hasActions" class="actions-cell">
						<button *ngFor="let action of actions" 
						        mat-raised-button
						        [color]="action.color || 'primary'"
						        (click)="onActionClick(action, row, $event)"
						        class="action-btn">
							{{ action.label }}
						</button>
					</td>
				</tr>
				<tr *ngIf="pagedData.length === 0">
					<td [attr.colspan]="columns.length + (hasActions ? 1 : 0)" style="text-align:center">No data</td>
				</tr>
			</tbody>
		</table>
	</div>
</div>

<div class="modal-overlay" *ngIf="showDownloadModal" (click)="closeDownloadModal()">
	<div class="modal-content" (click)="$event.stopPropagation()">
		<div class="modal-header">
			<h3>Izaberite format za preuzimanje</h3>
			<button class="close-btn" (click)="closeDownloadModal()">&times;</button>
		</div>
		<div class="modal-body">
			<div class="format-buttons">
				<button (click)="downloadAs('xml')" class="format-btn xml-btn">
					<span class="format-icon">ðŸ“„</span>
					XML
				</button>
				<button (click)="downloadAs('pdf')" class="format-btn pdf-btn">
					<span class="format-icon">ðŸ“„</span>
					PDF
				</button>
			</div>
		</div>
	</div>
</div>

<div class="pagination" *ngIf="totalPages > 1">
	<button mat-stroked-button 
	        (click)="goToPage(currentPage - 1)" 
	        [disabled]="currentPage === 1"
	        class="pagination-btn">
		<mat-icon>chevron_left</mat-icon>
		Nazad
	</button>
	<span class="pagination-info">Strana {{ currentPage }} od {{ totalPages }}</span>
	<button mat-stroked-button 
	        (click)="goToPage(currentPage + 1)" 
	        [disabled]="currentPage === totalPages"
	        class="pagination-btn">
		Napred
		<mat-icon>chevron_right</mat-icon>
	</button>
</div>
